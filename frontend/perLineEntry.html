<!doctype html>
<html lang="zh-Hant-TW">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes">
    <title>氣泡數登錄 (手機版)</title>
    <script src="//cdnjs.cloudflare.com/ajax/libs/numeral.js/1.4.5/numeral.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.15.2/moment.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js" charset="utf-8"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>

<body>
    <div class="container">
        <div class="row">
            <h2 class="col-xs-12 text-center" id="title">氣泡數登錄</h2>
        </div>
        <div class="row">
            <!-- <form class="container-fluid" id="seedCountForm" action="http://192.168.0.16:4949/seedCount/api/newEntry" method="post" enctype="multipart/form-data" onreset="runOnFormReset()"> -->
            <form class="form-horizontal" id="seedCountForm" action="http://upgi.ddns.net:4949/seedCount/api/newEntry" method="post" enctype="multipart/form-data" onreset="runOnFormReset()">
                <div class="form-group">
                    <label for="prodFacilityID" class="control-label col-xs-2">廠區</label>
                    <div class="col-xs-9">
                        <input type="text" class="form-control" name="prodFacilityID" id="prodFacilityID" value="新工總廠" readonly required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="prodLineID" class="control-label col-xs-2">生產線</label>
                    <div class="col-xs-9">
                        <input type="text" class="form-control" name="prodLineID" id="prodLineID" readonly required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="recordDate" class="control-label col-xs-2">工作日期</label>
                    <div class="col-xs-9">
                        <input type="date" class="form-control" name="mockRecordDate" id="mockRecordDate" required>
                        <input type="date" class="form-control" name="recordDate" id="recordDate" disabled required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="recordTime" class="control-label col-xs-2">記錄時段</label>
                    <div class="col-xs-9">
                        <input type="time" class="form-control" name="recordTime" id="recordTime" disabled required>
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label btn btn-default timeSelector" data-shift="早班" data-time="08:00"></label>
                    <label class="control-label btn btn-default timeSelector" data-shift="早班" data-time="10:00"></label>
                    <label class="control-label btn btn-default timeSelector" data-shift="早班" data-time="12:00"></label>
                    <label class="control-label btn btn-default timeSelector" data-shift="早班" data-time="14:00"></label>
                    <label class="control-label btn btn-default timeSelector" data-shift="中班" data-time="16:00"></label>
                    <label class="control-label btn btn-default timeSelector" data-shift="中班" data-time="18:00"></label>
                    <label class="control-label btn btn-default timeSelector" data-shift="中班" data-time="20:00"></label>
                    <label class="control-label btn btn-default timeSelector" data-shift="中班" data-time="22:00"></label>
                    <label class="control-label btn btn-default timeSelector crossOver" data-shift="夜班" data-time="00:00"></label>
                    <label class="control-label btn btn-default timeSelector crossOver" data-shift="夜班" data-time="02:00"></label>
                    <label class="control-label btn btn-default timeSelector crossOver" data-shift="夜班" data-time="04:00"></label>
                    <label class="control-label btn btn-default timeSelector crossOver" data-shift="夜班" data-time="06:00"></label>
                </div>
                <div class="form-group">
                    <label for="prodReference" class="control-label col-xs-2">瓶號</label>
                    <div class="col-xs-9">
                        <input type="text" class="form-control" name="prodReference" id="prodReference" size="10" maxlength="10" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="thickness" class="control-label col-xs-2">玻璃厚度</label>
                    <div class="col-xs-9">
                        <input type="number" class="form-control" name="thickness" id="thickness" min="0" max="30" step="0.05" required>
                    </div>
                </div>
                <div class="form-group">
                    <div class="input-group col-xs-8 col-xs-offset-1">
                        <span class="input-group-addon">氣泡記數項次 1</span>
                        <input type="number" class="form-control seedCountInput" name="seedCount[0]" min="0" max="30" step="1" required>
                        <span class="input-group-addon">必填</span>
                    </div>
                    <div class="input-group col-xs-8 col-xs-offset-1">
                        <span class="input-group-addon">氣泡記數項次 2</span>
                        <input type="number" class="form-control seedCountInput" name="seedCount[1]" min="0" max="30" step="1">
                    </div>
                    <div class="input-group col-xs-8 col-xs-offset-1">
                        <span class="input-group-addon">氣泡記數項次 3</span>
                        <input type="number" class="form-control seedCountInput" name="seedCount[2]" min="0" max="30" step="1">
                    </div>
                    <div class="input-group col-xs-8 col-xs-offset-1">
                        <span class="input-group-addon">氣泡記數項次 4</span>
                        <input type="number" class="form-control seedCountInput" name="seedCount[3]" min="0" max="30" step="1">
                    </div>
                    <div class="input-group col-xs-8 col-xs-offset-1">
                        <span class="input-group-addon">氣泡記數項次 5</span>
                        <input type="number" class="form-control seedCountInput" name="seedCount[4]" min="0" max="30" step="1">
                    </div>
                    <div class="input-group col-xs-8 col-xs-offset-1">
                        <span class="input-group-addon">氣泡記數項次 6</span>
                        <input type="number" class="form-control seedCountInput" name="seedCount[5]" min="0" max="30" step="1">
                    </div>
                </div>
                <div class="form-group">
                    <label for="note" class="control-label col-xs-2">備註</label>
                    <div class="col-xs-9">
                        <textarea class="form-control" name="note" id="note" rows="2" cols="50" placeholder="備註資訊"></textarea>
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-xs-offset-2 btn btn-default btn-file">
                        上傳相片<input type="file" name="photo" id="photo" style="display:none;" accept="image/*" capture="">
                    </label>
                </div>
            </form>
        </div>
    </div>
</body>

</html>

<script>
    $("document").ready(function() {
        $("#title").text(getUrlParameter("prodLineID") + " " + $("#title").text());
        $("#mockRecordDate").val(moment().format("YYYY-MM-DD"));
        $("#recordDate").val(moment().format("YYYY-MM-DD")).css("display", "none");
        $("#recordTime").css("pointer-events", "none")
        $(".timeSelector").each(function() {
            $(this).data("date", $("#mockRecordDate").val())
                .text($(this).data("shift") + " " + $(this).data("time"));
            if ($(this).hasClass("crossOver")) {
                $(this).data("date", moment($("#mockRecordDate").val()).add(1, "d").format("YYYY-MM-DD"));
            }
        });
        $("#prodLineID").val(getUrlParameter("prodLineID")).css("pointer-events", "none");

        $(".timeSelector").on("click", function() {
            $("#recordTime").val($(this).data("time"));
            if ($(this).hasClass("crossOver")) {
                $("#recordDate").val(moment($("#mockRecordDate").val()).add(1, 'd').format("YYYY-MM-DD"));
            } else {
                $("#recordDate").val(moment($("#mockRecordDate").val()).format("YYYY-MM-DD"));
            }
            $(".timeSelector").removeClass("btn-primary");
            $(this).addClass("btn-primary");
        });

        $("#mockRecordDate").change(function() {
            $("#recordTime").val("");
            $("#recordDate").val($(this).val());
            $(".timeSelector").each(function() {
                $(this).data("date", $("#mockRecordDate").val())
                    .text($(this).data("shift") + " " + $(this).data("time"));
                if ($(this).hasClass("crossOver")) {
                    $(this).data("date", moment($("#mockRecordDate").val()).add(1, "d").format("YYYY-MM-DD"));
                }
            });
            $(".timeSelector").removeClass("btn-primary");
        });
    });

    $("#seedCountForm").submit(function() {
        $("#recordTime").prop('disabled', false);
        $("#recordDate").prop('disabled', false);
    });

    function runOnFormReset() {
        $(".timeSelector").removeClass("btn-primary");
    }

    //javascript function to parse parameters from url
    var getUrlParameter = function getUrlParameter(sParam) {
        var sPageURL = decodeURIComponent(window.location.search.substring(1)),
            sURLVariables = sPageURL.split('&'),
            sParameterName,
            i;
        for (i = 0; i < sURLVariables.length; i++) {
            sParameterName = sURLVariables[i].split('=');
            if (sParameterName[0] === sParam) {
                return sParameterName[1] === undefined ? true : sParameterName[1];
            }
        }
    };
</script>